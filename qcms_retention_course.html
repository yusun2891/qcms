<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QCMS - Retention Course</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" rel="stylesheet">
  <style>
    :root {
      --primary-blue: #4C55EB;
      --primary-blue-hover: #3D45D9;
      --primary-blue-light: #EEF0FF;
      --font-1: #191F28;
      --font-2: #4E5968;
      --font-3: #8B95A1;
      --font-4: #B0B8C1;
      --bg-f9: #F9FAFB;
      --bg-f6: #F6F7F9;
      --bg-f3: #F3F4F6;
      --line-e: #E5E8EB;
      --line-d: #D1D6DB;
      --white: #FFFFFF;
      --success: #22C55E;
      --warning: #F59E0B;
      --error: #EF4444;
      
      --gnb-width-expanded: 224px;
      --gnb-width-collapsed: 56px;
      --transition-fast: 0.15s ease;
      --transition-normal: 0.25s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-f6);
      color: var(--font-1);
      height: 100vh;
      overflow: hidden;
    }

    /* GNB */
    .gnb {
      position: fixed;
      left: 0;
      top: 0;
      width: var(--gnb-width-expanded);
      height: 100vh;
      background: var(--white);
      border-right: 1px solid var(--line-e);
      display: flex;
      flex-direction: column;
      transition: width var(--transition-normal);
      z-index: 100;
    }

    .gnb.collapsed {
      width: var(--gnb-width-collapsed);
    }

    .gnb-header {
      height: 56px;
      padding: 0 16px;
      display: flex;
      align-items: center;
      flex-shrink: 0;
      cursor: pointer;
      transition: background var(--transition-fast);
    }

    .gnb-header:hover {
      background: var(--bg-f9);
    }

    .gnb-logo {
      display: flex;
      align-items: center;
      opacity: 1;
      transition: opacity var(--transition-fast);
    }

    .gnb.collapsed .gnb-logo {
      opacity: 0;
      position: absolute;
      pointer-events: none;
    }

    .gnb-logo-text {
      font-size: 18px;
      font-weight: 700;
      white-space: nowrap;
    }

    .gnb-logo-text span:first-child {
      color: var(--primary-blue);
    }

    .gnb-logo-text span:last-child {
      color: var(--font-1);
    }

    .gnb-hamburger {
      width: 24px;
      height: 24px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 4px;
      opacity: 0;
      position: absolute;
      pointer-events: none;
      transition: opacity var(--transition-fast);
    }

    .gnb.collapsed .gnb-hamburger {
      opacity: 1;
      position: relative;
      pointer-events: auto;
    }

    .gnb-hamburger span {
      display: block;
      width: 18px;
      height: 2px;
      background: var(--font-1);
      border-radius: 1px;
    }

    .gnb-nav {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      padding: 8px 0;
    }

    .gnb-nav::-webkit-scrollbar {
      width: 4px;
    }

    .gnb-nav::-webkit-scrollbar-track {
      background: transparent;
    }

    .gnb-nav::-webkit-scrollbar-thumb {
      background: var(--line-d);
      border-radius: 2px;
    }

    .menu-group {
      margin-bottom: 4px;
      position: relative;
    }

    .menu-group-header {
      display: flex;
      align-items: center;
      padding: 10px 16px;
      cursor: pointer;
      transition: background var(--transition-fast);
      position: relative;
    }

    .menu-group-header:hover {
      background: var(--bg-f9);
    }

    .menu-group-header.active {
      background: var(--bg-f3);
    }

    .menu-icon {
      width: 24px;
      height: 24px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .menu-icon svg {
      width: 20px;
      height: 20px;
      color: var(--font-2);
      transition: color var(--transition-fast);
    }

    .menu-group-header:hover .menu-icon svg,
    .menu-group-header.active .menu-icon svg {
      color: var(--primary-blue);
    }

    .menu-group-title {
      margin-left: 12px;
      font-size: 14px;
      font-weight: 500;
      color: var(--font-1);
      white-space: nowrap;
      flex: 1;
      opacity: 1;
      transition: opacity var(--transition-fast);
    }

    .gnb.collapsed .menu-group-title {
      opacity: 0;
    }

    .menu-arrow {
      width: 16px;
      height: 16px;
      transition: transform var(--transition-fast), opacity var(--transition-fast);
    }

    .menu-arrow svg {
      width: 16px;
      height: 16px;
      color: var(--font-3);
    }

    .gnb.collapsed .menu-arrow {
      opacity: 0;
    }

    .menu-group.open .menu-arrow {
      transform: rotate(180deg);
    }

    .submenu {
      max-height: 0;
      overflow: hidden;
      transition: max-height var(--transition-normal);
    }

    .menu-group.open .submenu {
      max-height: 500px;
    }

    .gnb.collapsed .submenu {
      max-height: 0 !important;
    }

    .submenu-item {
      display: flex;
      align-items: center;
      padding: 8px 16px 8px 52px;
      cursor: pointer;
      transition: background var(--transition-fast);
      text-decoration: none;
    }

    .submenu-item:hover {
      background: var(--bg-f9);
    }

    .submenu-item.active {
      background: var(--bg-f3);
    }

    .submenu-item-text {
      font-size: 13px;
      color: var(--font-2);
      white-space: nowrap;
    }

    .submenu-item.active .submenu-item-text {
      color: var(--primary-blue);
      font-weight: 500;
    }

    /* Floating Submenu */
    .floating-submenu {
      position: fixed;
      background: var(--white);
      border: 1px solid var(--line-e);
      border-radius: 8px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
      padding: 8px 0;
      min-width: 180px;
      z-index: 150;
      opacity: 0;
      visibility: hidden;
      transform: translateX(-8px);
      transition: all var(--transition-fast);
    }

    .floating-submenu.visible {
      opacity: 1;
      visibility: visible;
      transform: translateX(0);
    }

    .floating-submenu-title {
      padding: 8px 16px;
      font-size: 12px;
      font-weight: 600;
      color: var(--font-3);
      border-bottom: 1px solid var(--line-e);
      margin-bottom: 4px;
    }

    .floating-item {
      display: flex;
      align-items: center;
      padding: 8px 16px;
      cursor: pointer;
      transition: background var(--transition-fast);
      text-decoration: none;
    }

    .floating-item:hover {
      background: var(--bg-f9);
    }

    .floating-item.active {
      background: var(--bg-f3);
    }

    .floating-item-text {
      font-size: 13px;
      color: var(--font-2);
    }

    .floating-item.active .floating-item-text {
      color: var(--primary-blue);
      font-weight: 500;
    }

    /* Main Content */
    .main-wrapper {
      margin-left: var(--gnb-width-expanded);
      height: 100vh;
      display: flex;
      flex-direction: column;
      transition: margin-left var(--transition-normal);
    }

    .gnb.collapsed ~ .main-wrapper {
      margin-left: var(--gnb-width-collapsed);
    }

    .fixed-header {
      flex-shrink: 0;
      background: var(--bg-f6);
      padding: 16px 24px 0 24px;
    }

    /* Page Header */
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .page-header-left {
      display: flex;
      align-items: baseline;
      gap: 12px;
    }

    .page-title {
      font-size: 20px;
      font-weight: 700;
      color: var(--font-1);
    }

    .page-description {
      font-size: 13px;
      color: var(--font-3);
    }

    /* Content Card */
    .content-card {
      flex: 1;
      margin: 0 24px 24px 24px;
      background: var(--white);
      border-radius: 12px;
      border: 1px solid var(--line-e);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* Tabs */
    .tabs-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      border-bottom: 1px solid var(--line-e);
    }

    .tabs {
      display: flex;
      gap: 0;
    }

    .tab-item {
      padding: 16px 20px;
      font-size: 14px;
      font-weight: 500;
      color: var(--font-3);
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: all var(--transition-fast);
    }

    .tab-item:hover {
      color: var(--font-2);
    }

    .tab-item.active {
      color: var(--primary-blue);
      border-bottom-color: var(--primary-blue);
    }

    .tab-count {
      margin-left: 4px;
      font-weight: 400;
    }

    /* Toolbar */
    .toolbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 20px;
      border-bottom: 1px solid var(--line-e);
    }

    .toolbar-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .search-box {
      position: relative;
      width: 280px;
    }

    .search-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      width: 16px;
      height: 16px;
      color: var(--font-3);
    }

    .search-input {
      width: 100%;
      height: 36px;
      padding: 0 12px 0 36px;
      border: 1px solid var(--line-e);
      border-radius: 8px;
      font-size: 13px;
      color: var(--font-1);
      transition: border-color var(--transition-fast);
    }

    .search-input::placeholder {
      color: var(--font-4);
    }

    .search-input:focus {
      outline: none;
      border-color: var(--primary-blue);
    }

    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      height: 36px;
      padding: 0 16px;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all var(--transition-fast);
      border: none;
      white-space: nowrap;
    }

    .btn svg {
      width: 16px;
      height: 16px;
    }

    .btn-primary {
      background: var(--primary-blue);
      color: var(--white);
    }

    .btn-primary:hover {
      background: var(--primary-blue-hover);
    }

    .btn-primary:disabled {
      background: var(--line-d);
      cursor: not-allowed;
    }

    .btn-secondary {
      background: var(--white);
      color: var(--font-2);
      border: 1px solid var(--line-e);
    }

    .btn-secondary:hover:not(:disabled) {
      background: var(--bg-f9);
    }

    .btn-secondary:disabled {
      background: var(--bg-f9);
      color: var(--font-4);
      border-color: var(--line-e);
      cursor: not-allowed;
    }

    .btn-text {
      background: transparent;
      color: var(--font-3);
      padding: 0 12px;
    }

    .btn-text:hover {
      background: var(--bg-f9);
      color: var(--font-2);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-sm {
      height: 28px;
      padding: 0 10px;
      font-size: 12px;
    }

    .btn-warning {
      background: var(--warning);
      color: var(--white);
    }

    .btn-warning:hover {
      background: #E08E0A;
    }

    /* Table */
    .table-wrapper {
      flex: 1;
      overflow: auto;
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }

    .data-table thead {
      position: sticky;
      top: 0;
      z-index: 10;
      background: var(--bg-f9);
    }

    .data-table th {
      padding: 12px 16px;
      text-align: left;
      font-size: 12px;
      font-weight: 600;
      color: var(--font-3);
      border-bottom: 1px solid var(--line-e);
      white-space: nowrap;
    }

    .data-table td {
      padding: 14px 16px;
      font-size: 13px;
      color: var(--font-2);
      border-bottom: 1px solid var(--line-e);
      vertical-align: middle;
    }

    .data-table tbody tr:hover {
      background: var(--bg-f9);
    }

    /* Column widths */
    .col-no { width: 50px; text-align: center; }
    .col-textbook { width: 160px; }
    .col-section1 { width: 100px; }
    .col-section2 { width: 100px; }
    .col-title { width: auto; min-width: 180px; }
    .col-count { width: 100px; text-align: center; }
    .col-status { width: 120px; }
    .col-modified { width: 160px; white-space: nowrap; }
    .col-created { width: 160px; white-space: nowrap; }
    .col-action { width: 90px; text-align: center; }

    /* Status Badges */
    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 500;
    }

    .status-complete {
      background: #DCFCE7;
      color: #15803D;
    }

    .status-review {
      background: #FEF3C7;
      color: #B45309;
    }

    .status-review-warning {
      background: #FEE2E2;
      color: #DC2626;
    }

    .status-generating {
      background: #E0E7FF;
      color: #4338CA;
    }

    .status-draft {
      background: var(--bg-f3);
      color: var(--font-3);
    }

    .status-failed {
      background: #FEE2E2;
      color: #DC2626;
    }

    /* Pagination */
    .pagination-wrapper {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 20px;
      border-top: 1px solid var(--line-e);
      background: var(--white);
      flex-shrink: 0;
    }

    .pagination-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .pagination-info span {
      font-size: 12px;
      color: var(--font-2);
    }

    .page-size-select {
      height: 28px;
      padding: 0 24px 0 8px;
      border: 1px solid var(--line-d);
      border-radius: 4px;
      font-size: 12px;
      color: var(--font-1);
      background: var(--white) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%238B95A1' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E") no-repeat right 6px center;
      appearance: none;
      cursor: pointer;
    }

    .pagination-pages {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .page-btn {
      min-width: 28px;
      height: 28px;
      padding: 0 6px;
      border: 1px solid var(--line-d);
      border-radius: 4px;
      background: var(--white);
      font-size: 12px;
      color: var(--font-2);
      cursor: pointer;
      transition: all var(--transition-fast);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .page-btn:hover {
      background: var(--bg-f9);
      border-color: var(--font-3);
    }

    .page-btn.active {
      background: var(--primary-blue);
      border-color: var(--primary-blue);
      color: var(--white);
    }

    .page-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .page-btn svg {
      width: 14px;
      height: 14px;
    }

    /* Side Peek */
    .side-peek-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.3);
      z-index: 200;
      opacity: 0;
      visibility: hidden;
      transition: all var(--transition-normal);
    }

    .side-peek-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .side-peek {
      position: fixed;
      top: 0;
      right: 0;
      width: 50%;
      min-width: 600px;
      height: 100vh;
      background: var(--white);
      box-shadow: -4px 0 24px rgba(0, 0, 0, 0.12);
      z-index: 201;
      display: flex;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform var(--transition-normal);
    }

    .side-peek-overlay.show .side-peek {
      transform: translateX(0);
    }

    .side-peek-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 24px;
      border-bottom: 1px solid var(--line-e);
      flex-shrink: 0;
    }

    .side-peek-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--font-1);
    }

    .side-peek-close {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      border: none;
      background: transparent;
      color: var(--font-3);
      cursor: pointer;
      border-radius: 6px;
      transition: all var(--transition-fast);
    }

    .side-peek-close:hover {
      background: var(--bg-f9);
      color: var(--font-1);
    }

    .side-peek-body {
      flex: 1;
      overflow-y: auto;
      padding: 24px;
    }

    .side-peek-footer {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 8px;
      padding: 16px 24px;
      border-top: 1px solid var(--line-e);
      flex-shrink: 0;
    }

    /* Form Sections */
    .form-section {
      margin-bottom: 32px;
    }

    .form-section:last-child {
      margin-bottom: 0;
    }

    .form-section-title {
      font-size: 15px;
      font-weight: 600;
      color: var(--font-1);
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .form-section-title .required {
      color: var(--error);
    }

    .form-row {
      margin-bottom: 16px;
    }

    .form-row:last-child {
      margin-bottom: 0;
    }

    .form-label {
      display: block;
      font-size: 14px;
      font-weight: 500;
      color: var(--font-2);
      margin-bottom: 8px;
    }

    .form-label .required {
      color: var(--error);
      margin-left: 2px;
    }

    .form-label .optional {
      color: var(--font-3);
      font-weight: 400;
      margin-left: 4px;
    }

    .form-input {
      width: 100%;
      padding: 10px 14px;
      border: 1px solid var(--line-d);
      border-radius: 8px;
      font-size: 14px;
      color: var(--font-1);
      transition: border-color var(--transition-fast);
    }

    .form-input:focus {
      outline: none;
      border-color: var(--primary-blue);
    }

    .form-input::placeholder {
      color: var(--font-4);
    }

    .form-select {
      width: 100%;
      padding: 10px 14px;
      border: 1px solid var(--line-d);
      border-radius: 8px;
      font-size: 14px;
      color: var(--font-1);
      background: var(--white);
      cursor: pointer;
    }

    .form-select:focus {
      outline: none;
      border-color: var(--primary-blue);
    }

    .form-textarea {
      width: 100%;
      min-height: 200px;
      padding: 14px;
      border: 1px solid var(--line-d);
      border-radius: 8px;
      font-size: 14px;
      color: var(--font-1);
      resize: vertical;
      font-family: inherit;
      line-height: 1.6;
    }

    .form-textarea:focus {
      outline: none;
      border-color: var(--primary-blue);
    }

    .form-hint {
      font-size: 13px;
      color: var(--font-3);
      margin-top: 6px;
    }

    .form-row-inline {
      display: flex;
      gap: 12px;
    }

    .form-row-inline .form-field {
      flex: 1;
    }

    /* Section2 Single-Select Dropdown */
    .section2-select-wrapper {
      position: relative;
    }

    .section2-select-input {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 42px;
      padding: 0 36px 0 14px;
      border: 1px solid var(--line-d);
      border-radius: 8px;
      background: var(--white);
      cursor: pointer;
      position: relative;
    }

    .section2-select-input:focus,
    .section2-select-input.active {
      border-color: var(--primary-blue);
    }

    .section2-select-input.disabled {
      background: var(--bg-f9);
      cursor: not-allowed;
      opacity: 0.6;
    }

    .section2-select-arrow {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--font-3);
      pointer-events: none;
    }

    .section2-selected-text {
      font-size: 14px;
      color: var(--font-1);
    }

    .section2-selected-text.placeholder {
      color: var(--font-4);
    }

    .section2-dropdown {
      display: none;
      position: absolute;
      top: calc(100% + 4px);
      left: 0;
      right: 0;
      background: var(--white);
      border: 1px solid var(--line-e);
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      z-index: 100;
      max-height: 240px;
      overflow-y: auto;
    }

    .section2-dropdown.show {
      display: block;
    }

    .section2-option {
      padding: 10px 14px;
      font-size: 14px;
      color: var(--font-1);
      cursor: pointer;
      transition: background var(--transition-fast);
    }

    .section2-option:hover {
      background: var(--bg-f9);
    }

    .section2-option.selected {
      background: var(--primary-blue-light);
      color: var(--primary-blue);
    }

    .section2-option.disabled {
      color: var(--font-4);
      cursor: not-allowed;
      text-decoration: line-through;
    }

    .section2-option.disabled:hover {
      background: transparent;
    }

    .section2-option.add-option {
      display: flex;
      align-items: center;
      gap: 6px;
      color: var(--primary-blue);
      border-top: 1px solid var(--line-e);
      margin-top: 4px;
      padding-top: 10px;
    }

    .section2-option.add-option:hover {
      background: var(--primary-blue-light);
    }

    /* Searchable Select */
    .searchable-select {
      position: relative;
    }

    .searchable-select-input {
      width: 100%;
      padding: 10px 14px;
      padding-right: 36px;
      border: 1px solid var(--line-d);
      border-radius: 8px;
      font-size: 14px;
      color: var(--font-1);
      background: var(--white);
      cursor: pointer;
    }

    .searchable-select-input:focus {
      outline: none;
      border-color: var(--primary-blue);
    }

    .searchable-select-arrow {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--font-3);
      pointer-events: none;
    }

    .searchable-select-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: var(--white);
      border: 1px solid var(--line-d);
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      z-index: 10;
      max-height: 240px;
      overflow-y: auto;
      display: none;
    }

    .searchable-select-dropdown.show {
      display: block;
    }

    .searchable-select-option {
      padding: 10px 14px;
      cursor: pointer;
      font-size: 14px;
    }

    .searchable-select-option:hover {
      background: var(--bg-f9);
    }

    .searchable-select-option.disabled {
      color: var(--font-4);
      cursor: not-allowed;
      background: var(--bg-f9);
    }

    /* Section Divider */
    .section-divider {
      height: 1px;
      background: var(--line-e);
      margin: 24px 0;
    }

    /* Upload Area */
    .upload-area {
      border: 2px dashed var(--line-d);
      border-radius: 8px;
      padding: 32px;
      text-align: center;
      background: var(--bg-f9);
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .upload-area:hover {
      border-color: var(--primary-blue);
      background: var(--primary-blue-light);
    }

    .upload-area-icon {
      margin-bottom: 12px;
      color: var(--font-3);
    }

    .upload-area-text {
      font-size: 14px;
      color: var(--font-2);
      margin-bottom: 4px;
    }

    .upload-area-hint {
      font-size: 13px;
      color: var(--font-3);
    }

    .uploaded-file {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      background: var(--bg-f9);
      border: 1px solid var(--line-e);
      border-radius: 8px;
    }

    .uploaded-file-icon {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--primary-blue-light);
      border-radius: 8px;
      color: var(--primary-blue);
    }

    .uploaded-file-info {
      flex: 1;
    }

    .uploaded-file-name {
      font-size: 14px;
      font-weight: 500;
      color: var(--font-1);
    }

    .uploaded-file-size {
      font-size: 13px;
      color: var(--font-3);
    }

    .uploaded-file-remove {
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      border: none;
      color: var(--font-3);
      cursor: pointer;
      border-radius: 6px;
    }

    .uploaded-file-remove:hover {
      background: #FEE2E2;
      color: var(--error);
    }

    /* Paragraph Editor */
    .paragraph-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .paragraph-item {
      display: flex;
      gap: 12px;
      align-items: flex-start;
    }

    .paragraph-number {
      flex-shrink: 0;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--primary-blue);
      color: var(--white);
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
    }

    .paragraph-number-input {
      flex-shrink: 0;
      width: 56px;
    }

    .page-number-input {
      width: 100%;
      height: 32px;
      padding: 0 8px;
      border: 1px solid var(--line-d);
      border-radius: 6px;
      font-size: 13px;
      text-align: center;
      color: var(--font-1);
      background: var(--white);
    }

    .page-number-input:focus {
      outline: none;
      border-color: var(--primary-blue);
    }

    .page-number-input::placeholder {
      color: var(--font-4);
    }

    .paragraph-content {
      flex: 1;
    }

    .paragraph-textarea {
      width: 100%;
      min-height: 60px;
      padding: 12px;
      border: 1px solid var(--line-d);
      border-radius: 8px;
      font-size: 14px;
      line-height: 1.6;
      resize: none;
      overflow-y: hidden;
      font-family: inherit;
      box-sizing: border-box;
    }

    .paragraph-textarea:focus {
      outline: none;
      border-color: var(--primary-blue);
    }

    .paragraph-delete {
      flex-shrink: 0;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      border: 1px solid var(--line-d);
      border-radius: 6px;
      color: var(--font-3);
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .paragraph-delete:hover {
      background: #FEE2E2;
      border-color: var(--error);
      color: var(--error);
    }

    .add-paragraph-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      width: 100%;
      padding: 14px;
      margin-top: 12px;
      border: 2px dashed var(--line-d);
      border-radius: 8px;
      background: transparent;
      color: var(--font-3);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .add-paragraph-btn.page-type {
      margin-left: 68px; /* 56px (input width) + 12px (gap) */
      width: calc(100% - 68px);
    }

    .add-paragraph-btn:hover {
      border-color: var(--primary-blue);
      color: var(--primary-blue);
      background: var(--primary-blue-light);
    }

    .add-paragraph-btn svg {
      flex-shrink: 0;
    }

    /* Radio Group */
    .radio-group {
      display: flex;
      gap: 24px;
    }

    .radio-item {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
    }

    .radio-item input[type="radio"] {
      width: 18px;
      height: 18px;
      accent-color: var(--primary-blue);
    }

    .radio-item label {
      font-size: 14px;
      color: var(--font-1);
      cursor: pointer;
    }

    /* Checkbox Group */
    .checkbox-group {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
    }

    .checkbox-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .checkbox-item input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: var(--primary-blue);
    }

    .checkbox-item label {
      font-size: 14px;
      color: var(--font-1);
      cursor: pointer;
    }

    /* Word Input Table */
    .word-input-table {
      width: 100%;
      border-collapse: collapse;
      border: 1px solid var(--line-d);
      border-radius: 8px;
      overflow: hidden;
    }

    .word-input-table th,
    .word-input-table td {
      padding: 8px 12px;
      border: 1px solid var(--line-e);
      font-size: 14px;
    }

    .word-input-table th {
      background: var(--bg-f3);
      font-weight: 500;
      color: var(--font-2);
    }

    .word-input-table input {
      width: 100%;
      padding: 8px;
      border: 1px solid transparent;
      border-radius: 4px;
      font-size: 14px;
      background: transparent;
    }

    .word-input-table input:focus {
      outline: none;
      border-color: var(--primary-blue);
      background: var(--white);
    }

    .word-input-table .row-delete {
      width: 32px;
      text-align: center;
    }

    .word-input-table .row-delete button {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      border: none;
      color: var(--font-3);
      cursor: pointer;
      border-radius: 4px;
    }

    .word-input-table .row-delete button:hover {
      background: #FEE2E2;
      color: var(--error);
    }

    .table-actions {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 12px;
      margin-bottom: 8px;
    }

    .table-actions .btn svg {
      flex-shrink: 0;
    }

    .table-toolbar {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 12px;
      margin-bottom: 8px;
      min-height: 28px;
    }

    .table-toolbar .selected-count {
      font-size: 13px;
      color: var(--font-2);
    }

    .table-toolbar .selected-count strong {
      color: var(--primary-blue);
    }

    .table-toolbar .delete-selected-btn {
      color: var(--font-3);
    }

    .table-toolbar .delete-selected-btn:not(:disabled):hover {
      color: var(--error);
      background: #FEE2E2;
    }

    .table-toolbar .delete-selected-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .table-hint {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-top: 8px;
      font-size: 13px;
      color: var(--font-3);
    }

    .table-hint-item {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .table-hint-item kbd {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 2px 6px;
      background: var(--bg-f3);
      border: 1px solid var(--line-d);
      border-radius: 4px;
      font-size: 12px;
      font-family: monospace;
    }

    /* AI Auto Extract Info */
    .auto-extract-info {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      padding: 12px 16px;
      background: var(--primary-blue-light);
      border-radius: 8px;
      margin-top: 12px;
    }

    .auto-extract-info svg {
      color: var(--primary-blue);
      flex-shrink: 0;
      margin-top: 2px;
    }

    .auto-extract-info-text {
      font-size: 14px;
      color: var(--primary-blue);
      line-height: 1.5;
    }

    /* Hidden state */
    .paragraph-editor-container {
      display: none;
    }

    .paragraph-editor-container.show {
      display: block;
    }

    .passage-input-container.hide {
      display: none;
    }

    /* Modal */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .modal-overlay.show {
      display: flex;
    }

    .modal {
      background: var(--white);
      border-radius: 12px;
      width: 500px;
      max-height: 85vh;
      display: flex;
      flex-direction: column;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 24px;
      border-bottom: 1px solid var(--line-e);
      flex-shrink: 0;
    }

    .modal-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--font-1);
    }

    .modal-close {
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: none;
      background: none;
      cursor: pointer;
      border-radius: 6px;
      color: var(--font-3);
    }

    .modal-close:hover {
      background: var(--bg-f3);
    }

    .modal-body {
      flex: 1;
      padding: 24px;
      overflow-y: auto;
    }

    .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 12px;
      padding: 16px 24px;
      border-top: 1px solid var(--line-e);
      flex-shrink: 0;
    }

    /* Toast */
    .toast {
      position: fixed;
      bottom: 32px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: var(--font-1);
      color: var(--white);
      padding: 14px 24px;
      border-radius: 8px;
      font-size: 14px;
      z-index: 300;
      opacity: 0;
      transition: all var(--transition-normal);
    }

    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
  </style>
</head>
<body>
  <!-- GNB -->
  <nav class="gnb" id="gnb">
    <div class="gnb-header" id="gnbHeader">
      <div class="gnb-logo">
        <div class="gnb-logo-text">
          <span>Q</span><span>CMS</span>
        </div>
      </div>
      <div class="gnb-hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
    
    <div class="gnb-nav">
      <!-- 커리큘럼 관리 -->
      <div class="menu-group" data-menu="curriculum">
        <div class="menu-group-header">
          <div class="menu-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
              <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
            </svg>
          </div>
          <span class="menu-group-title">커리큘럼 관리</span>
          <div class="menu-arrow">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </div>
        </div>
        <div class="submenu">
          <a class="submenu-item" href="#" data-page="quarter-settings">
            <span class="submenu-item-text">분기 설정</span>
          </a>
          <a class="submenu-item" href="#" data-page="textbook-register">
            <span class="submenu-item-text">교재 등록</span>
          </a>
          <a class="submenu-item" href="#" data-page="curriculum-assign">
            <span class="submenu-item-text">커리큘럼 배정</span>
          </a>
        </div>
      </div>

      <!-- 콘텐츠 관리 -->
      <div class="menu-group open" data-menu="contents">
        <div class="menu-group-header active">
          <div class="menu-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
              <polyline points="2 17 12 22 22 17"></polyline>
              <polyline points="2 12 12 17 22 12"></polyline>
            </svg>
          </div>
          <span class="menu-group-title">콘텐츠 관리</span>
          <div class="menu-arrow">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </div>
        </div>
        <div class="submenu">
          <a class="submenu-item" href="#" data-page="circular-course">
            <span class="submenu-item-text">Circular Course</span>
          </a>
          <a class="submenu-item active" href="#" data-page="retention-course">
            <span class="submenu-item-text">Retention Course</span>
          </a>
        </div>
      </div>

      <!-- Prompt 관리 -->
      <div class="menu-group" data-menu="prompt">
        <div class="menu-group-header">
          <div class="menu-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="4 17 10 11 4 5"></polyline>
              <line x1="12" y1="19" x2="20" y2="19"></line>
            </svg>
          </div>
          <span class="menu-group-title">Prompt 관리</span>
          <div class="menu-arrow">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </div>
        </div>
        <div class="submenu">
          <a class="submenu-item" href="#" data-page="content-prompt">
            <span class="submenu-item-text">콘텐츠 생성 Prompt</span>
          </a>
          <a class="submenu-item" href="#" data-page="module-prompt">
            <span class="submenu-item-text">학습 모듈 Prompt</span>
          </a>
        </div>
      </div>

      <!-- 이용 현황 -->
      <div class="menu-group" data-menu="usage">
        <div class="menu-group-header">
          <div class="menu-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="20" x2="18" y2="10"></line>
              <line x1="12" y1="20" x2="12" y2="4"></line>
              <line x1="6" y1="20" x2="6" y2="14"></line>
            </svg>
          </div>
          <span class="menu-group-title">이용 현황</span>
          <div class="menu-arrow">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </div>
        </div>
        <div class="submenu">
          <a class="submenu-item" href="#" data-page="teacher-status">
            <span class="submenu-item-text">선생님 현황</span>
          </a>
          <a class="submenu-item" href="#" data-page="student-status">
            <span class="submenu-item-text">학생 현황</span>
          </a>
        </div>
      </div>

      <!-- 환경설정 -->
      <div class="menu-group" data-menu="settings">
        <div class="menu-group-header">
          <div class="menu-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </svg>
          </div>
          <span class="menu-group-title">환경설정</span>
          <div class="menu-arrow">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </div>
        </div>
        <div class="submenu">
          <a class="submenu-item" href="#" data-page="module-settings">
            <span class="submenu-item-text">학습 모듈 설정</span>
          </a>
          <a class="submenu-item" href="#" data-page="media-manage">
            <span class="submenu-item-text">미디어 관리</span>
          </a>
          <a class="submenu-item" href="#" data-page="popup-settings">
            <span class="submenu-item-text">팝업창 설정</span>
          </a>
          <a class="submenu-item" href="#" data-page="permission-manage">
            <span class="submenu-item-text">권한 관리</span>
          </a>
          <a class="submenu-item" href="#" data-page="notification-manage">
            <span class="submenu-item-text">알림 관리</span>
          </a>
          <a class="submenu-item" href="#" data-page="code-manage">
            <span class="submenu-item-text">코드 관리</span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Floating Submenu -->
  <div class="floating-submenu" id="floatingSubmenu"></div>

  <!-- Main Content -->
  <main class="main-wrapper">
    <div class="fixed-header">
      <div class="page-header">
        <div class="page-header-left">
          <h1 class="page-title">Retention Course</h1>
          <p class="page-description">단어 학습 콘텐츠를 등록하고 관리합니다.</p>
        </div>
      </div>
    </div>

    <div class="content-card">
      <!-- Tabs -->
      <div class="tabs-container">
        <div class="tabs">
          <div class="tab-item active" onclick="switchTab(this, 'all')">
            전체<span class="tab-count">(12)</span>
          </div>
          <div class="tab-item" onclick="switchTab(this, 'draft')">
            임시 저장<span class="tab-count">(1)</span>
          </div>
          <div class="tab-item" onclick="switchTab(this, 'generating')">
            AI 생성 중<span class="tab-count">(1)</span>
          </div>
          <div class="tab-item" onclick="switchTab(this, 'failed')">
            생성 실패<span class="tab-count">(1)</span>
          </div>
          <div class="tab-item" onclick="switchTab(this, 'review')">
            검수 대기<span class="tab-count">(8)</span>
          </div>
          <div class="tab-item" onclick="switchTab(this, 'complete')">
            완료<span class="tab-count">(1)</span>
          </div>
        </div>
      </div>

      <!-- Toolbar -->
      <div class="toolbar">
        <div class="toolbar-left">
          <div class="search-box">
            <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
            <input type="text" class="search-input" placeholder="교재명, 제목으로 검색">
          </div>
        </div>
        <button class="btn btn-primary" onclick="openSidePeek()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 5v14M5 12h14"></path>
          </svg>
          콘텐츠 입력
        </button>
      </div>

      <!-- Table -->
      <div class="table-wrapper">
        <table class="data-table">
          <thead>
            <tr>
              <th class="col-no">No.</th>
              <th class="col-textbook">교재명</th>
              <th class="col-section1">구분1</th>
              <th class="col-section2">구분2</th>
              <th class="col-title">제목</th>
              <th class="col-count">단어 개수</th>
              <th class="col-status">상태</th>
              <th class="col-modified">최근 수정</th>
              <th class="col-created">등록 정보</th>
              <th class="col-action"></th>
            </tr>
          </thead>
          <tbody>
            <tr onclick="location.href='qcms_retention_review.html'" style="cursor: pointer;">
              <td class="col-no">10</td>
              <td class="col-textbook">Insight Link</td>
              <td class="col-section1">Part 2</td>
              <td class="col-section2">Section 1</td>
              <td class="col-title">The Science of Sleep</td>
              <td class="col-count">8</td>
              <td class="col-status">
                <span class="status-badge status-complete">완료</span>
              </td>
              <td class="col-modified">김영희, 2026-01-18</td>
              <td class="col-created">홍길동, 2026-01-10</td>
              <td class="col-action">
                <button class="btn btn-text btn-sm" onclick="event.stopPropagation(); location.href='qcms_retention_review.html'">보기</button>
              </td>
            </tr>
            <tr onclick="location.href='qcms_retention_review.html'" style="cursor: pointer;">
              <td class="col-no">9</td>
              <td class="col-textbook">Academic Reading</td>
              <td class="col-section1">Theme 1</td>
              <td class="col-section2">Article 1</td>
              <td class="col-title">Wonders of the Ocean</td>
              <td class="col-count">6</td>
              <td class="col-status">
                <span class="status-badge status-review-warning">검수 대기 ⚠️3</span>
              </td>
              <td class="col-modified">홍길동, 2026-01-17</td>
              <td class="col-created">홍길동, 2026-01-08</td>
              <td class="col-action">
                <button class="btn btn-warning btn-sm" onclick="event.stopPropagation(); location.href='qcms_retention_review.html'">⚠️ 검수</button>
              </td>
            </tr>
            <tr onclick="location.href='qcms_retention_review.html'" style="cursor: pointer;">
              <td class="col-no">8</td>
              <td class="col-textbook">TOEFL Reading</td>
              <td class="col-section1">Passage 3</td>
              <td class="col-section2">-</td>
              <td class="col-title">Climate Change</td>
              <td class="col-count">5</td>
              <td class="col-status">
                <span class="status-badge status-review">검수 대기</span>
              </td>
              <td class="col-modified">박철수, 2026-01-16</td>
              <td class="col-created">박철수, 2026-01-06</td>
              <td class="col-action">
                <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); location.href='qcms_retention_review.html'">검수</button>
              </td>
            </tr>
            <tr onclick="location.href='qcms_retention_review.html'" style="cursor: pointer;">
              <td class="col-no">7</td>
              <td class="col-textbook">Grammar in Use</td>
              <td class="col-section1">Chapter 2</td>
              <td class="col-section2">-</td>
              <td class="col-title">Present Perfect Tense</td>
              <td class="col-count">7</td>
              <td class="col-status">
                <span class="status-badge status-review">검수 대기</span>
              </td>
              <td class="col-modified">이지영, 2026-01-15</td>
              <td class="col-created">이지영, 2026-01-05</td>
              <td class="col-action">
                <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); location.href='qcms_retention_review.html'">검수</button>
              </td>
            </tr>
            <tr onclick="showToast('AI가 콘텐츠를 생성 중입니다. 생성 완료 후 검수할 수 있습니다.')" style="cursor: pointer;">
              <td class="col-no">6</td>
              <td class="col-textbook">Reading Explorer 3</td>
              <td class="col-section1">Unit 5</td>
              <td class="col-section2">Lesson 1</td>
              <td class="col-title">Technology Revolution</td>
              <td class="col-count">4</td>
              <td class="col-status">
                <span class="status-badge status-generating">AI 생성 중</span>
              </td>
              <td class="col-modified">-</td>
              <td class="col-created">김민수, 2026-01-14</td>
              <td class="col-action">
                <button class="btn btn-secondary btn-sm" disabled>대기 중</button>
              </td>
            </tr>
            <tr onclick="location.href='qcms_retention_review.html'" style="cursor: pointer;">
              <td class="col-no">5</td>
              <td class="col-textbook">Insight Link</td>
              <td class="col-section1">Part 3</td>
              <td class="col-section2">Section 2</td>
              <td class="col-title">Space Exploration</td>
              <td class="col-count">6</td>
              <td class="col-status">
                <span class="status-badge status-review-warning">검수 대기 ⚠️1</span>
              </td>
              <td class="col-modified">정수진, 2026-01-13</td>
              <td class="col-created">정수진, 2026-01-03</td>
              <td class="col-action">
                <button class="btn btn-warning btn-sm" onclick="event.stopPropagation(); location.href='qcms_retention_review.html'">⚠️ 검수</button>
              </td>
            </tr>
            <tr onclick="location.href='qcms_retention_review.html'" style="cursor: pointer;">
              <td class="col-no">4</td>
              <td class="col-textbook">Academic Reading</td>
              <td class="col-section1">Theme 2</td>
              <td class="col-section2">Article 3</td>
              <td class="col-title">Marine Biology</td>
              <td class="col-count">5</td>
              <td class="col-status">
                <span class="status-badge status-review">검수 대기</span>
              </td>
              <td class="col-modified">최영미, 2026-01-12</td>
              <td class="col-created">최영미, 2026-01-02</td>
              <td class="col-action">
                <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); location.href='qcms_retention_review.html'">검수</button>
              </td>
            </tr>
            <tr onclick="location.href='qcms_retention_review.html'" style="cursor: pointer;">
              <td class="col-no">3</td>
              <td class="col-textbook">Reading Explorer 1</td>
              <td class="col-section1">Unit 1</td>
              <td class="col-section2">-</td>
              <td class="col-title">World Cultures</td>
              <td class="col-count">4</td>
              <td class="col-status">
                <span class="status-badge status-review">검수 대기</span>
              </td>
              <td class="col-modified">강호진, 2026-01-11</td>
              <td class="col-created">강호진, 2026-01-01</td>
              <td class="col-action">
                <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); location.href='qcms_retention_review.html'">검수</button>
              </td>
            </tr>
            <tr onclick="openSidePeekEdit()" style="cursor: pointer;">
              <td class="col-no">2</td>
              <td class="col-textbook">TOEFL Reading</td>
              <td class="col-section1">Passage 1</td>
              <td class="col-section2">-</td>
              <td class="col-title">Natural Disasters</td>
              <td class="col-count">5</td>
              <td class="col-status">
                <span class="status-badge status-failed">생성 실패</span>
              </td>
              <td class="col-modified">윤지혜, 2026-01-10</td>
              <td class="col-created">윤지혜, 2025-12-28</td>
              <td class="col-action">
                <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); retryGeneration()">재시도</button>
              </td>
            </tr>
            <tr onclick="openSidePeekEdit()" style="cursor: pointer;">
              <td class="col-no">1</td>
              <td class="col-textbook">Grammar in Use</td>
              <td class="col-section1">Chapter 1</td>
              <td class="col-section2">-</td>
              <td class="col-title">Introduction to Tenses</td>
              <td class="col-count">3</td>
              <td class="col-status">
                <span class="status-badge status-draft">임시 저장</span>
              </td>
              <td class="col-modified">-</td>
              <td class="col-created">김철수, 2025-12-25</td>
              <td class="col-action">
                <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); openSidePeekEdit()">편집</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <div class="pagination-wrapper">
        <div class="pagination-info">
          <select class="page-size-select">
            <option value="30">30개씩</option>
            <option value="50">50개씩</option>
            <option value="80">80개씩</option>
            <option value="100">100개씩</option>
            <option value="200">200개씩</option>
          </select>
          <span>총 <strong>12</strong>개</span>
        </div>
        <div class="pagination-pages">
          <button class="page-btn" disabled>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
          </button>
          <button class="page-btn active">1</button>
          <button class="page-btn" disabled>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </main>

  <!-- Side Peek: 콘텐츠 입력 -->
  <div class="side-peek-overlay" id="sidePeekOverlay" onclick="closeSidePeekOutside(event)">
    <div class="side-peek">
      <div class="side-peek-header">
        <h2 class="side-peek-title">콘텐츠 입력</h2>
        <button class="side-peek-close" onclick="closeSidePeek()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>

      <div class="side-peek-body">
        <!-- 기본 정보 -->
        <div class="form-section">
          <h3 class="form-section-title">기본 정보</h3>
          
          <div class="form-row">
            <label class="form-label">교재<span class="required">*</span></label>
            <div class="searchable-select">
              <input type="text" class="searchable-select-input" id="textbookInput" placeholder="교재 검색 또는 선택" onclick="toggleTextbookDropdown()" oninput="filterTextbooks()">
              <div class="searchable-select-arrow">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
              </div>
              <div class="searchable-select-dropdown" id="textbookDropdown">
                <!-- 동적으로 생성됨 -->
              </div>
            </div>
          </div>

          <!-- 구분2가 없는 교재 선택 시 -->
          <div class="form-row" id="sectionFieldsNoLesson" style="display: none;">
            <label class="form-label">콘텐츠 정보<span class="required">*</span></label>
            <div class="form-field">
              <select class="form-select" id="section1SelectNoLesson">
                <!-- 동적으로 생성됨 -->
              </select>
            </div>
          </div>

          <!-- 구분2가 있는 교재 선택 시 -->
          <div class="form-row" id="sectionFieldsWithLesson" style="display: none;">
            <label class="form-label">콘텐츠 정보<span class="required">*</span></label>
            <div class="form-row-inline">
              <div class="form-field" style="flex: 0 0 140px;">
                <select class="form-select" id="section1SelectWithLesson" onchange="onSection1WithLessonChange()">
                  <!-- 동적으로 생성됨 -->
                </select>
              </div>
              <div class="form-field" style="flex: 1;">
                <div class="section2-select-wrapper">
                  <div class="section2-select-input" id="section2SelectInput" onclick="toggleSection2Dropdown()">
                    <span class="section2-selected-text placeholder" id="section2SelectedText">선택</span>
                    <div class="section2-select-arrow">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                      </svg>
                    </div>
                  </div>
                  <div class="section2-dropdown" id="section2Dropdown">
                    <!-- 동적으로 생성됨 -->
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 단어 난이도 -->
          <div class="form-row" id="passageLevelField" style="display: none;">
            <label class="form-label">단어 난이도<span class="required">*</span></label>
            <select class="form-select" id="passageLevel" onchange="updateSaveButtonStates()">
              <option value="" disabled selected>선택</option>
              <option value="BL1">BL1</option>
              <option value="BL2">BL2</option>
              <option value="BL3">BL3</option>
              <option value="BL4">BL4</option>
              <option value="BL5">BL5</option>
              <option value="BL6">BL6</option>
              <option value="BL7">BL7</option>
              <option value="BL8">BL8</option>
              <option value="BL9">BL9</option>
              <option value="BL10">BL10</option>
            </select>
          </div>

          <!-- 제목 (선택) -->
          <div class="form-row" id="titleField" style="display: none;">
            <label class="form-label">제목<span class="optional">(선택)</span></label>
            <input type="text" class="form-input" id="passageTitle" placeholder="제목 입력">
          </div>
        </div>

        <div class="section-divider"></div>

        <!-- 단어 입력 -->
        <div class="form-section">
          <h3 class="form-section-title">단어 입력<span class="required">*</span></h3>
          
          <!-- 안내 문구 -->
          <div class="auto-extract-info" style="margin-bottom: 16px; background: #FEF3C7; border: 1px solid #F59E0B;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#F59E0B" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M12 16v-4"></path>
              <path d="M12 8h.01"></path>
            </svg>
            <span class="auto-extract-info-text" style="color: #92400E;">최소 1개 이상의 단어를 입력해야 저장할 수 있습니다. 품사, 한글 뜻, 영어 뜻, 예문은 미입력 시 AI가 자동 생성합니다.</span>
          </div>

          <div class="form-row" style="margin-bottom: 16px;">
            <label class="form-label">입력 항목 선택</label>
            <div class="checkbox-group">
              <div class="checkbox-item">
                <input type="checkbox" id="colWord" checked disabled>
                <label for="colWord">단어 (필수)</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" id="colPos" onchange="updateWordTableColumns()">
                <label for="colPos">품사</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" id="colKorDef" checked onchange="updateWordTableColumns()">
                <label for="colKorDef">한글 뜻</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" id="colEngDef" onchange="updateWordTableColumns()">
                <label for="colEngDef">영어 뜻</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" id="colExample" onchange="updateWordTableColumns()">
                <label for="colExample">예문</label>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="table-toolbar">
              <span class="selected-count" id="selectedWordCount" style="display: none;">
                <strong id="selectedWordNum">0</strong>개 선택됨
              </span>
              <button class="btn btn-text btn-sm delete-selected-btn" id="deleteSelectedBtn" onclick="deleteSelectedWords()" disabled>
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="3 6 5 6 21 6"></polyline>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                </svg>
                선택 삭제
              </button>
            </div>
            <table class="word-input-table" id="wordInputTable">
              <thead>
                <tr>
                  <th style="width: 36px;"><input type="checkbox" id="selectAllWords" onchange="toggleSelectAllWords()"></th>
                  <th style="width: 50px;">No.</th>
                  <th>단어</th>
                  <th class="col-pos" style="display: none;">품사</th>
                  <th class="col-kor-def">한글 뜻</th>
                  <th class="col-eng-def" style="display: none;">영어 뜻</th>
                  <th class="col-example" style="display: none;">예문</th>
                  <th class="row-delete"></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="text-align: center;"><input type="checkbox" class="word-row-checkbox" onchange="updateSelectAllState()"></td>
                  <td style="text-align: center;">1</td>
                  <td><input type="text" placeholder="단어 입력"></td>
                  <td class="col-pos" style="display: none;"><input type="text" placeholder="품사"></td>
                  <td class="col-kor-def"><input type="text" placeholder="한글 뜻"></td>
                  <td class="col-eng-def" style="display: none;"><input type="text" placeholder="영어 뜻"></td>
                  <td class="col-example" style="display: none;"><input type="text" placeholder="예문"></td>
                  <td class="row-delete">
                    <button onclick="deleteWordRow(this)">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                      </svg>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td style="text-align: center;"><input type="checkbox" class="word-row-checkbox" onchange="updateSelectAllState()"></td>
                  <td style="text-align: center;">2</td>
                  <td><input type="text" placeholder="단어 입력"></td>
                  <td class="col-pos" style="display: none;"><input type="text" placeholder="품사"></td>
                  <td class="col-kor-def"><input type="text" placeholder="한글 뜻"></td>
                  <td class="col-eng-def" style="display: none;"><input type="text" placeholder="영어 뜻"></td>
                  <td class="col-example" style="display: none;"><input type="text" placeholder="예문"></td>
                  <td class="row-delete">
                    <button onclick="deleteWordRow(this)">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                      </svg>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td style="text-align: center;"><input type="checkbox" class="word-row-checkbox" onchange="updateSelectAllState()"></td>
                  <td style="text-align: center;">3</td>
                  <td><input type="text" placeholder="단어 입력"></td>
                  <td class="col-pos" style="display: none;"><input type="text" placeholder="품사"></td>
                  <td class="col-kor-def"><input type="text" placeholder="한글 뜻"></td>
                  <td class="col-eng-def" style="display: none;"><input type="text" placeholder="영어 뜻"></td>
                  <td class="col-example" style="display: none;"><input type="text" placeholder="예문"></td>
                  <td class="row-delete">
                    <button onclick="deleteWordRow(this)">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                      </svg>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
            <div class="table-actions">
              <button class="btn btn-secondary btn-sm" onclick="addWordRow()">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                행 추가
              </button>
            </div>
            <div class="table-hint">
              <span class="table-hint-item">
                <kbd>Tab</kbd> 마지막 셀에서 누르면 새 행 추가
              </span>
              <span class="table-hint-item">
                <kbd>Ctrl</kbd> + <kbd>V</kbd> 엑셀에서 복사한 내용 붙여넣기 가능
              </span>
            </div>
          </div>
        </div>
      </div>

      <div class="side-peek-footer">
        <button class="btn btn-secondary" id="btnDelete" onclick="deleteDraftContent()" style="display: none; margin-right: auto; color: #DC2626; border-color: #DC2626;">삭제</button>
        <button class="btn btn-secondary" onclick="closeSidePeek()">취소</button>
        <button class="btn btn-secondary" id="btnSaveDraft" onclick="saveDraft()" disabled>저장 후 계속 입력</button>
        <button class="btn btn-primary" id="btnSave" onclick="saveAndGenerate()" disabled>저장</button>
      </div>
    </div>
  </div>

  <!-- Delete Confirm Modal -->
  <div class="modal-overlay" id="deleteModal">
    <div class="modal" style="width: 400px;">
      <div class="modal-header">
        <h3 class="modal-title">콘텐츠를 삭제하시겠습니까?</h3>
        <button class="modal-close" onclick="closeDeleteModal()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <p style="color: #4E5968; line-height: 1.6;">임시저장된 콘텐츠가 삭제됩니다. 이 작업은 되돌릴 수 없습니다.</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeDeleteModal()">취소</button>
        <button class="btn btn-primary" style="background: #DC2626;" onclick="confirmDelete()">삭제</button>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast">
    <span id="toastMessage">저장되었습니다.</span>
  </div>

  <script>
    // GNB Toggle
    const gnb = document.getElementById('gnb');
    const floatingSubmenu = document.getElementById('floatingSubmenu');
    const menuGroups = document.querySelectorAll('.menu-group');
    
    let currentActivePage = 'retention-course';
    let isOverFloating = false;
    
    const menuData = {
      'curriculum': {
        title: '커리큘럼 관리',
        items: [
          { page: 'quarter-settings', text: '분기 설정' },
          { page: 'textbook-register', text: '교재 등록' },
          { page: 'curriculum-assign', text: '커리큘럼 배정' }
        ]
      },
      'contents': {
        title: '콘텐츠 관리',
        items: [
          { page: 'circular-course', text: 'Circular Course' },
          { page: 'retention-course', text: 'Retention Course' }
        ]
      },
      'prompt': {
        title: 'Prompt 관리',
        items: [
          { page: 'content-prompt', text: '콘텐츠 생성 Prompt' },
          { page: 'module-prompt', text: '학습 모듈 Prompt' }
        ]
      },
      'usage': {
        title: '이용 현황',
        items: [
          { page: 'teacher-status', text: '선생님 현황' },
          { page: 'student-status', text: '학생 현황' }
        ]
      },
      'settings': {
        title: '환경설정',
        items: [
          { page: 'module-settings', text: '학습 모듈 설정' },
          { page: 'media-manage', text: '미디어 관리' },
          { page: 'popup-settings', text: '팝업창 설정' },
          { page: 'permission-manage', text: '권한 관리' },
          { page: 'notification-manage', text: '알림 관리' },
          { page: 'code-manage', text: '코드 관리' }
        ]
      }
    };

    // GNB 빈 영역 클릭 시 접기/펼치기
    gnb.addEventListener('click', (e) => {
      if (e.target.closest('.submenu-item') || e.target.closest('.menu-group-header')) return;
      gnb.classList.toggle('collapsed');
      hideFloatingSubmenu();
    });

    // 메뉴 그룹 헤더 클릭/호버 이벤트
    menuGroups.forEach(group => {
      const header = group.querySelector('.menu-group-header');
      const menuKey = group.dataset.menu;

      header.addEventListener('click', (e) => {
        e.stopPropagation();
        if (!gnb.classList.contains('collapsed')) {
          group.classList.toggle('open');
        }
      });

      header.addEventListener('mouseenter', () => {
        if (gnb.classList.contains('collapsed')) {
          showFloatingSubmenu(menuKey, header);
        }
      });

      header.addEventListener('mouseleave', () => {
        if (gnb.classList.contains('collapsed')) {
          setTimeout(() => {
            if (!isOverFloating) hideFloatingSubmenu();
          }, 50);
        }
      });
    });

    floatingSubmenu.addEventListener('mouseenter', () => { isOverFloating = true; });
    floatingSubmenu.addEventListener('mouseleave', () => { isOverFloating = false; hideFloatingSubmenu(); });

    function showFloatingSubmenu(menuKey, headerElement) {
      const data = menuData[menuKey];
      if (!data) return;
      const rect = headerElement.getBoundingClientRect();
      const gnbWidth = gnb.classList.contains('collapsed') ? 56 : 224;
      floatingSubmenu.style.left = `${gnbWidth + 4}px`;
      floatingSubmenu.style.top = `${rect.top}px`;
      let html = `<div class="floating-submenu-title">${data.title}</div>`;
      data.items.forEach(item => {
        const isActive = item.page === currentActivePage ? 'active' : '';
        html += `<a class="floating-item ${isActive}" href="#" data-page="${item.page}"><span class="floating-item-text">${item.text}</span></a>`;
      });
      floatingSubmenu.innerHTML = html;
      floatingSubmenu.classList.add('visible');
    }

    function hideFloatingSubmenu() {
      floatingSubmenu.classList.remove('visible');
    }

    // ===== 교재 데이터 =====
    const textbookData = {
      // 구분2 없는 교재 (3개)
      'Reading Explorer 1': {
        hasSection2: false,
        splitType: 'paragraph',
        section1Name: 'Unit',
        section1List: [
          { value: 'u1', name: 'Unit 1', registered: false },
          { value: 'u2', name: 'Unit 2', registered: false },
          { value: 'u3', name: 'Unit 3', registered: true },
          { value: 'u4', name: 'Unit 4', registered: false },
          { value: 'u5', name: 'Unit 5', registered: false }
        ]
      },
      'Grammar in Use': {
        hasSection2: false,
        splitType: 'paragraph',
        section1Name: 'Chapter',
        section1List: [
          { value: 'c1', name: 'Chapter 1', registered: false },
          { value: 'c2', name: 'Chapter 2', registered: true },
          { value: 'c3', name: 'Chapter 3', registered: false },
          { value: 'c4', name: 'Chapter 4', registered: false },
          { value: 'c5', name: 'Chapter 5', registered: false }
        ]
      },
      'TOEFL Reading': {
        hasSection2: false,
        splitType: 'page',
        section1Name: 'Passage',
        section1List: [
          { value: 'p1', name: 'Passage 1', registered: false },
          { value: 'p2', name: 'Passage 2', registered: false },
          { value: 'p3', name: 'Passage 3', registered: true },
          { value: 'p4', name: 'Passage 4', registered: false },
          { value: 'p5', name: 'Passage 5', registered: false }
        ]
      },
      // 구분2 있는 교재 (3개)
      'Reading Explorer 3': {
        hasSection2: true,
        splitType: 'paragraph',
        section1Name: 'Unit',
        section2Name: 'Lesson',
        section1List: [
          { value: 'u1', name: 'Unit 1', registered: false },
          { value: 'u2', name: 'Unit 2', registered: false },
          { value: 'u3', name: 'Unit 3', registered: false },
          { value: 'u4', name: 'Unit 4', registered: false },
          { value: 'u5', name: 'Unit 5', registered: false }
        ],
        section2List: [
          { value: 'l1', name: 'Lesson 1', registered: false },
          { value: 'l2', name: 'Lesson 2', registered: false },
          { value: 'l3', name: 'Lesson 3', registered: false }
        ],
        // 특정 Unit의 특정 Lesson이 등록된 경우
        registeredCombinations: ['u1-l2', 'u3-l1']
      },
      'Insight Link': {
        hasSection2: true,
        splitType: 'page',
        section1Name: 'Part',
        section2Name: 'Section',
        section1List: [
          { value: 'p1', name: 'Part 1', registered: false },
          { value: 'p2', name: 'Part 2', registered: false },
          { value: 'p3', name: 'Part 3', registered: false },
          { value: 'p4', name: 'Part 4', registered: false }
        ],
        section2List: [
          { value: 's1', name: 'Section 1', registered: false },
          { value: 's2', name: 'Section 2', registered: false },
          { value: 's3', name: 'Section 3', registered: false }
        ],
        registeredCombinations: ['p2-s1', 'p2-s3']
      },
      'Academic Reading': {
        hasSection2: true,
        splitType: 'paragraph',
        section1Name: 'Theme',
        section2Name: 'Article',
        section1List: [
          { value: 't1', name: 'Theme 1', registered: false },
          { value: 't2', name: 'Theme 2', registered: false },
          { value: 't3', name: 'Theme 3', registered: false },
          { value: 't4', name: 'Theme 4', registered: false }
        ],
        section2List: [
          { value: 'a1', name: 'Article 1', registered: false },
          { value: 'a2', name: 'Article 2', registered: false },
          { value: 'a3', name: 'Article 3', registered: false }
        ],
        registeredCombinations: ['t1-a1', 't3-a2']
      }
    };

    // 현재 상태 변수들
    let currentTextbook = null;
    let hasSection2 = false;
    let currentSplitType = 'paragraph';
    let selectedSection2 = null;
    let section2Count = 3;

    // 페이지 로드 시 교재 드롭다운 초기화
    document.addEventListener('DOMContentLoaded', function() {
      initTextbookDropdown();
    });

    function initTextbookDropdown() {
      const dropdown = document.getElementById('textbookDropdown');
      let html = '';
      Object.keys(textbookData).sort().forEach(name => {
        html += `<div class="searchable-select-option" data-name="${name}" onclick="selectTextbook('${name}')">${name}</div>`;
      });
      dropdown.innerHTML = html;
    }

    // GNB Toggle
    function toggleGnb() {
      document.getElementById('gnb').classList.toggle('collapsed');
    }

    function toggleMenu(header) {
      const group = header.closest('.menu-group');
      group.classList.toggle('open');
    }

    // Tab Switch
    function switchTab(element, tabName) {
      document.querySelectorAll('.tab-item').forEach(tab => tab.classList.remove('active'));
      element.classList.add('active');
    }

    // Side Peek
    let isEditMode = false;
    
    function openSidePeek() {
      isEditMode = false;
      document.getElementById('sidePeekOverlay').classList.add('show');
      document.body.style.overflow = 'hidden';
      // 신규 모드: 삭제 버튼 숨김, 저장 후 계속 입력 버튼 표시
      document.getElementById('btnDelete').style.display = 'none';
      document.getElementById('btnSaveDraft').style.display = 'inline-flex';
      document.querySelector('.side-peek-title').textContent = '콘텐츠 입력';
    }

    function openSidePeekEdit() {
      isEditMode = true;
      document.getElementById('sidePeekOverlay').classList.add('show');
      document.body.style.overflow = 'hidden';
      // 편집 모드: 삭제 버튼 표시, 저장 후 계속 입력 버튼 숨김
      document.getElementById('btnDelete').style.display = 'inline-flex';
      document.getElementById('btnSaveDraft').style.display = 'none';
      document.querySelector('.side-peek-title').textContent = '콘텐츠 수정';
      // 여기에 기존 데이터 로드 로직 추가
    }

    function closeSidePeek() {
      document.getElementById('sidePeekOverlay').classList.remove('show');
      document.body.style.overflow = '';
      isEditMode = false;
    }

    function closeSidePeekOutside(event) {
      if (event.target === event.currentTarget) {
        closeSidePeek();
      }
    }

    // Delete Modal
    function deleteDraftContent() {
      document.getElementById('deleteModal').classList.add('show');
    }

    function closeDeleteModal() {
      document.getElementById('deleteModal').classList.remove('show');
    }

    function confirmDelete() {
      closeDeleteModal();
      closeSidePeek();
      showToast('콘텐츠가 삭제되었습니다.');
    }

    // Retry Generation
    function retryGeneration() {
      showToast('AI 콘텐츠 생성을 재시도합니다.');
    }

    // Searchable Textbook Dropdown
    function toggleTextbookDropdown() {
      const dropdown = document.getElementById('textbookDropdown');
      dropdown.classList.toggle('show');
    }

    function filterTextbooks() {
      const input = document.getElementById('textbookInput').value.toLowerCase();
      const options = document.querySelectorAll('#textbookDropdown .searchable-select-option');
      options.forEach(opt => {
        const text = opt.textContent.toLowerCase();
        opt.style.display = text.includes(input) ? 'block' : 'none';
      });
      document.getElementById('textbookDropdown').classList.add('show');
    }

    function selectTextbook(name) {
      const data = textbookData[name];
      if (!data) return;
      
      currentTextbook = name;
      document.getElementById('textbookInput').value = name;
      document.getElementById('textbookDropdown').classList.remove('show');
      
      hasSection2 = data.hasSection2;
      currentSplitType = data.splitType || 'paragraph';
      selectedSection2 = null;
      section2Count = data.section2List ? data.section2List.length : 3;
      
      // 구분1 드롭다운 생성
      if (hasSection2) {
        document.getElementById('sectionFieldsNoLesson').style.display = 'none';
        document.getElementById('sectionFieldsWithLesson').style.display = 'block';
        populateSection1WithLesson(data);
        populateSection2Dropdown(data, null);
        // 구분2 비활성화 상태로 설정 (구분1 선택 전)
        document.getElementById('section2SelectInput').classList.add('disabled');
      } else {
        document.getElementById('sectionFieldsNoLesson').style.display = 'block';
        document.getElementById('sectionFieldsWithLesson').style.display = 'none';
        populateSection1NoLesson(data);
      }
      
      // 제목 필드 표시
      document.getElementById('passageLevelField').style.display = 'block';
      document.getElementById('passageTypeField').style.display = 'block';
      document.getElementById('upperTitleField').style.display = 'block';
      document.getElementById('titleField').style.display = 'block';
      document.getElementById('subtitleField').style.display = 'block';
      
      // 문단/페이지 분리 워딩 변경
      const splitLabel = currentSplitType === 'page' ? '페이지' : '문단';
      document.getElementById('splitBtnText').textContent = splitLabel + ' 분리하기';
      document.getElementById('editLabelText').textContent = splitLabel;
      document.getElementById('addBtnText').textContent = splitLabel + ' 추가';
      document.getElementById('splitHint').textContent = currentSplitType === 'page' 
        ? '빈 줄(엔터 2번)로 페이지가 구분됩니다.' 
        : '빈 줄(엔터 2번)로 문단이 구분됩니다.';
      
      // 플레이스홀더 변경
      const textarea = document.getElementById('passageTextarea');
      textarea.placeholder = currentSplitType === 'page'
        ? '전체 지문을 붙여넣으세요. 페이지를 구분하려면 빈 줄(엔터 2번)을 넣어주세요.'
        : '전체 지문을 붙여넣으세요. 문단을 구분하려면 빈 줄(엔터 2번)을 넣어주세요.';
      
      // 버튼 상태 업데이트
      updateSaveButtonStates();
    }

    function populateSection1NoLesson(data) {
      const select = document.getElementById('section1SelectNoLesson');
      let html = `<option value="">${data.section1Name} 선택</option>`;
      data.section1List.forEach(item => {
        const disabled = item.registered ? 'disabled' : '';
        const suffix = item.registered ? ' (등록됨)' : '';
        html += `<option value="${item.value}" ${disabled}>${item.name}${suffix}</option>`;
      });
      select.innerHTML = html;
    }

    function populateSection1WithLesson(data) {
      const select = document.getElementById('section1SelectWithLesson');
      let html = `<option value="">${data.section1Name} 선택</option>`;
      data.section1List.forEach(item => {
        html += `<option value="${item.value}">${item.name}</option>`;
      });
      select.innerHTML = html;
    }

    function onSection1WithLessonChange() {
      const data = textbookData[currentTextbook];
      if (!data) return;
      
      const section1Value = document.getElementById('section1SelectWithLesson').value;
      selectedSection2 = null;
      updateSection2Display();
      populateSection2Dropdown(data, section1Value);
      
      // 구분1 선택 여부에 따라 구분2 활성화/비활성화
      const section2Input = document.getElementById('section2SelectInput');
      if (section1Value) {
        section2Input.classList.remove('disabled');
      } else {
        section2Input.classList.add('disabled');
      }
      
      // 버튼 상태 업데이트
      updateSaveButtonStates();
    }

    function populateSection2Dropdown(data, section1Value) {
      const dropdown = document.getElementById('section2Dropdown');
      const placeholder = document.getElementById('section2SelectedText');
      
      placeholder.textContent = `${data.section2Name} 선택`;
      placeholder.classList.add('placeholder');
      
      let html = '';
      data.section2List.forEach(item => {
        const combinationKey = section1Value ? `${section1Value}-${item.value}` : null;
        const isRegistered = combinationKey && data.registeredCombinations && 
                            data.registeredCombinations.includes(combinationKey);
        const disabledClass = isRegistered ? 'disabled' : '';
        const suffix = isRegistered ? ' (등록됨)' : '';
        
        html += `<div class="section2-option ${disabledClass}" data-value="${item.value}" 
                  onclick="${isRegistered ? '' : `selectSection2('${item.value}', '${item.name}')`}">
                  ${item.name}${suffix}
                </div>`;
      });
      
      html += `<div class="section2-option add-option" onclick="addNewSection2()">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 5v14M5 12h14"></path>
        </svg>
        ${data.section2Name} 추가
      </div>`;
      
      dropdown.innerHTML = html;
    }

    // Section2 Dropdown (단일 선택)
    function toggleSection2Dropdown() {
      // 구분1이 선택되지 않은 경우 드롭다운 열지 않음
      const section1Value = document.getElementById('section1SelectWithLesson').value;
      if (!section1Value) {
        const data = textbookData[currentTextbook];
        const section1Name = data ? data.section1Name : '구분1';
        showToast(`먼저 ${section1Name}을(를) 선택해주세요.`);
        return;
      }
      
      const dropdown = document.getElementById('section2Dropdown');
      const input = document.getElementById('section2SelectInput');
      dropdown.classList.toggle('show');
      input.classList.toggle('active', dropdown.classList.contains('show'));
      updateSection2DropdownState();
    }

    function updateSection2DropdownState() {
      const options = document.querySelectorAll('#section2Dropdown .section2-option:not(.add-option)');
      options.forEach(opt => {
        const value = opt.dataset.value;
        const isSelected = selectedSection2 && selectedSection2.value === value;
        opt.classList.toggle('selected', isSelected);
      });
    }

    function selectSection2(value, name) {
      selectedSection2 = { value, name };
      updateSection2Display();
      
      // 드롭다운 닫기
      document.getElementById('section2Dropdown').classList.remove('show');
      document.getElementById('section2SelectInput').classList.remove('active');
      
      // 버튼 상태 업데이트
      updateSaveButtonStates();
    }

    function updateSection2Display() {
      const textEl = document.getElementById('section2SelectedText');
      if (!textEl) return;
      
      const data = textbookData[currentTextbook];
      const section2Name = data ? data.section2Name : 'Lesson';
      
      if (selectedSection2) {
        textEl.textContent = selectedSection2.name;
        textEl.classList.remove('placeholder');
      } else {
        textEl.textContent = `${section2Name} 선택`;
        textEl.classList.add('placeholder');
      }
    }

    function addNewSection2() {
      const data = textbookData[currentTextbook];
      if (!data) return;
      
      section2Count++;
      const newValue = 's' + section2Count;
      const newName = `${data.section2Name} ${section2Count}`;
      
      // 드롭다운에 새 옵션 추가 (add-option 앞에)
      const dropdown = document.getElementById('section2Dropdown');
      const addOption = dropdown.querySelector('.add-option');
      
      const newOption = document.createElement('div');
      newOption.className = 'section2-option';
      newOption.dataset.value = newValue;
      newOption.onclick = function() { selectSection2(newValue, newName); };
      newOption.textContent = newName;
      
      dropdown.insertBefore(newOption, addOption);
      
      // 새로 추가된 Section2 자동 선택
      selectSection2(newValue, newName);
    }

    // 클릭 외부 영역 감지하여 드롭다운 닫기
    document.addEventListener('click', function(e) {
      // 교재 드롭다운
      const textbookDropdown = document.getElementById('textbookDropdown');
      const textbookInput = document.getElementById('textbookInput');
      if (textbookDropdown && !textbookDropdown.contains(e.target) && e.target !== textbookInput) {
        textbookDropdown.classList.remove('show');
      }
      
      // 구분2 드롭다운
      const section2Wrapper = document.querySelector('.section2-select-wrapper');
      const section2Dropdown = document.getElementById('section2Dropdown');
      const section2Input = document.getElementById('section2SelectInput');
      if (section2Wrapper && !section2Wrapper.contains(e.target)) {
        section2Dropdown.classList.remove('show');
        section2Input.classList.remove('active');
      }
    });

    // Audio File Upload
    function onAudioFileSelect(event) {
      const file = event.target.files[0];
      if (file) {
        document.getElementById('audioUploadArea').style.display = 'none';
        document.getElementById('uploadedAudioFile').style.display = 'block';
        document.getElementById('audioFileName').textContent = file.name;
        document.getElementById('audioFileSize').textContent = (file.size / (1024 * 1024)).toFixed(2) + ' MB';
      }
    }

    function removeAudioFile() {
      document.getElementById('audioUploadArea').style.display = 'block';
      document.getElementById('uploadedAudioFile').style.display = 'none';
      document.getElementById('audioFileInput').value = '';
    }

    // Paragraph Editor
    function splitParagraphs() {
      const text = document.getElementById('passageTextarea').value;
      const paragraphs = text.split(/\n\s*\n/).filter(p => p.trim());
      
      if (paragraphs.length === 0) {
        showToast('지문을 먼저 입력해주세요.');
        return;
      }

      const list = document.getElementById('paragraphList');
      list.innerHTML = '';
      
      paragraphs.forEach((p, idx) => {
        addParagraphItem(idx + 1, p.trim());
      });

      document.getElementById('passageInputContainer').classList.add('hide');
      document.getElementById('paragraphEditorContainer').classList.add('show');
      
      // 버튼 클래스 및 텍스트 업데이트
      const addBtn = document.getElementById('addParagraphBtn');
      if (currentSplitType === 'page') {
        addBtn.classList.add('page-type');
      } else {
        addBtn.classList.remove('page-type');
      }
      
      // DOM 렌더링 후 모든 textarea 높이 조절
      setTimeout(() => {
        document.querySelectorAll('.paragraph-textarea').forEach(ta => autoResize(ta));
        updateSaveButtonStates();
      }, 10);
    }

    function addParagraphItem(num, content = '') {
      const list = document.getElementById('paragraphList');
      const isPageType = currentSplitType === 'page';
      const splitLabel = isPageType ? '페이지' : '문단';
      
      const item = document.createElement('div');
      item.className = 'paragraph-item';
      
      if (isPageType) {
        // 페이지 분할: 페이지 번호 입력 필드 포함
        item.innerHTML = `
          <div class="paragraph-number-input">
            <input type="text" class="page-number-input" placeholder="p." value="" maxlength="5">
          </div>
          <div class="paragraph-content">
            <textarea class="paragraph-textarea" placeholder="${splitLabel} 내용" oninput="autoResize(this)">${content}</textarea>
          </div>
          <button class="paragraph-delete" onclick="deleteParagraph(this)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        `;
      } else {
        // 문단 분할: 자동 번호
        item.innerHTML = `
          <div class="paragraph-number">${num}</div>
          <div class="paragraph-content">
            <textarea class="paragraph-textarea" placeholder="${splitLabel} ${num} 내용" oninput="autoResize(this)">${content}</textarea>
          </div>
          <button class="paragraph-delete" onclick="deleteParagraph(this)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        `;
      }
      
      list.appendChild(item);
      
      // DOM에 추가된 후 높이 조절
      setTimeout(() => {
        const textarea = item.querySelector('.paragraph-textarea');
        autoResize(textarea);
      }, 0);
    }

    function autoResize(textarea) {
      if (!textarea) return;
      textarea.style.height = 'auto';
      const newHeight = Math.max(60, textarea.scrollHeight);
      textarea.style.height = newHeight + 'px';
    }

    function addParagraph() {
      const list = document.getElementById('paragraphList');
      const count = list.children.length + 1;
      addParagraphItem(count);
    }

    function deleteParagraph(btn) {
      const item = btn.closest('.paragraph-item');
      item.remove();
      // 문단 타입일 때만 번호 재정렬
      if (currentSplitType !== 'page') {
        renumberParagraphs();
      }
    }

    function renumberParagraphs() {
      const items = document.querySelectorAll('.paragraph-item');
      items.forEach((item, idx) => {
        const numEl = item.querySelector('.paragraph-number');
        if (numEl) {
          numEl.textContent = idx + 1;
        }
      });
    }

    function resetPassageInput() {
      document.getElementById('passageInputContainer').classList.remove('hide');
      document.getElementById('paragraphEditorContainer').classList.remove('show');
      document.getElementById('paragraphList').innerHTML = '';
      updateSaveButtonStates();
    }

    // Word Input Type
    function onWordInputTypeChange() {
      const isManual = document.getElementById('wordManual').checked;
      document.getElementById('autoExtractInfo').style.display = isManual ? 'none' : 'block';
      document.getElementById('manualInputArea').style.display = isManual ? 'block' : 'none';
    }

    // 컬럼 토글
    function updateWordTableColumns() {
      const showPos = document.getElementById('colPos').checked;
      const showKor = document.getElementById('colKorDef').checked;
      const showEng = document.getElementById('colEngDef').checked;
      const showExample = document.getElementById('colExample').checked;
      
      document.querySelectorAll('.col-pos').forEach(el => {
        el.style.display = showPos ? '' : 'none';
      });
      document.querySelectorAll('.col-kor-def').forEach(el => {
        el.style.display = showKor ? '' : 'none';
      });
      document.querySelectorAll('.col-eng-def').forEach(el => {
        el.style.display = showEng ? '' : 'none';
      });
      document.querySelectorAll('.col-example').forEach(el => {
        el.style.display = showExample ? '' : 'none';
      });
    }

    // Word Table
    function deleteWordRow(btn) {
      const tbody = document.querySelector('#wordInputTable tbody');
      if (tbody.rows.length <= 1) {
        showToast('최소 1개의 행이 필요합니다.');
        return;
      }
      const row = btn.closest('tr');
      row.remove();
      renumberWordRows();
      updateSelectAllState();
    }

    // Tab키로 새 행 추가
    document.getElementById('wordInputTable').addEventListener('keydown', function(e) {
      if (e.key === 'Tab' && !e.shiftKey) {
        const inputs = Array.from(this.querySelectorAll('tbody input')).filter(input => {
          return input.offsetParent !== null; // visible inputs only
        });
        const lastInput = inputs[inputs.length - 1];
        if (document.activeElement === lastInput) {
          e.preventDefault();
          addWordRow();
          const newInputs = Array.from(this.querySelectorAll('tbody tr:last-child input')).filter(input => {
            return input.offsetParent !== null;
          });
          if (newInputs.length > 0) {
            newInputs[0].focus();
          }
        }
      }
    });

    // 체크박스 이벤트 위임 (동적으로 추가된 행에도 적용)
    document.getElementById('wordInputTable').addEventListener('change', function(e) {
      if (e.target.classList.contains('word-row-checkbox') || e.target.id === 'selectAllWords') {
        if (e.target.id === 'selectAllWords') {
          toggleSelectAllWords();
        } else {
          updateSelectAllState();
        }
      }
    });

    // 엑셀 복붙 지원 (셀 내 줄바꿈 처리 포함)
    document.getElementById('wordInputTable').addEventListener('paste', function(e) {
      const clipboardData = e.clipboardData || window.clipboardData;
      const pastedData = clipboardData.getData('text');
      
      if (pastedData.includes('\t') || pastedData.includes('\n')) {
        e.preventDefault();
        
        // 엑셀 데이터 파싱 (셀 내 줄바꿈 처리)
        const rows = parseExcelData(pastedData);
        const tbody = this.querySelector('tbody');
        const startRowIndex = Array.from(tbody.rows).indexOf(e.target.closest('tr'));
        
        rows.forEach((cells, i) => {
          let row = tbody.rows[startRowIndex + i];
          
          if (!row) {
            addWordRow();
            row = tbody.rows[tbody.rows.length - 1];
          }
          
          // 체크박스와 No. 제외한 텍스트 input만 선택
          const inputs = Array.from(row.querySelectorAll('td input[type="text"]')).filter(input => input.offsetParent !== null);
          cells.forEach((cell, j) => {
            if (inputs[j]) {
              inputs[j].value = cell.trim();
            }
          });
        });
        
        showToast('데이터가 붙여넣기 되었습니다.');
      }
    });

    // 엑셀 데이터 파싱 함수 (셀 내 줄바꿈 처리)
    function parseExcelData(data) {
      const rows = [];
      let currentRow = [];
      let currentCell = '';
      let inQuotes = false;
      
      for (let i = 0; i < data.length; i++) {
        const char = data[i];
        const nextChar = data[i + 1];
        
        if (char === '"') {
          if (inQuotes && nextChar === '"') {
            // 이스케이프된 쌍따옴표
            currentCell += '"';
            i++;
          } else {
            // 쌍따옴표 시작/끝
            inQuotes = !inQuotes;
          }
        } else if (char === '\t' && !inQuotes) {
          // 탭: 셀 구분
          currentRow.push(currentCell);
          currentCell = '';
        } else if ((char === '\r' || char === '\n') && !inQuotes) {
          // 줄바꿈: 행 구분 (쌍따옴표 밖에서만)
          if (char === '\r' && nextChar === '\n') {
            i++; // \r\n 처리
          }
          if (currentCell || currentRow.length > 0) {
            currentRow.push(currentCell);
            rows.push(currentRow);
            currentRow = [];
            currentCell = '';
          }
        } else {
          currentCell += char;
        }
      }
      
      // 마지막 셀/행 처리
      if (currentCell || currentRow.length > 0) {
        currentRow.push(currentCell);
        rows.push(currentRow);
      }
      
      return rows;
    }

    // 전체 선택 토글
    function toggleSelectAllWords() {
      const selectAll = document.getElementById('selectAllWords');
      const checkboxes = document.querySelectorAll('.word-row-checkbox');
      checkboxes.forEach(cb => cb.checked = selectAll.checked);
      
      // 선택 카운트 및 삭제 버튼 상태 업데이트
      updateSelectAllState();
    }

    // 전체 선택 상태 업데이트
    function updateSelectAllState() {
      const checkboxes = document.querySelectorAll('.word-row-checkbox');
      const selectAll = document.getElementById('selectAllWords');
      const countEl = document.getElementById('selectedWordCount');
      const countNumEl = document.getElementById('selectedWordNum');
      const deleteBtn = document.getElementById('deleteSelectedBtn');
      
      // 요소가 없으면 리턴
      if (!selectAll || !countEl || !countNumEl || !deleteBtn) return;
      
      const checkedCount = Array.from(checkboxes).filter(cb => cb.checked).length;
      const allChecked = checkboxes.length > 0 && checkedCount === checkboxes.length;
      
      selectAll.checked = allChecked;
      selectAll.indeterminate = checkedCount > 0 && !allChecked;
      
      // 선택 카운트 및 삭제 버튼 상태 업데이트
      if (checkedCount > 0) {
        countEl.style.display = 'inline';
        countNumEl.textContent = checkedCount;
        deleteBtn.disabled = false;
      } else {
        countEl.style.display = 'none';
        deleteBtn.disabled = true;
      }
    }

    // 선택된 행 삭제
    function deleteSelectedWords() {
      const checkboxes = document.querySelectorAll('.word-row-checkbox:checked');
      if (checkboxes.length === 0) {
        showToast('삭제할 항목을 선택해주세요.');
        return;
      }
      
      const totalSelected = checkboxes.length;
      const tbody = document.querySelector('#wordInputTable tbody');
      const baseRowCount = 3; // 기본 행 개수
      
      // 선택된 행들을 역순으로 처리 (인덱스 변동 방지)
      const checkedRows = Array.from(checkboxes).map(cb => cb.closest('tr'));
      checkedRows.reverse().forEach(row => {
        if (tbody.rows.length > baseRowCount) {
          // 기본 행 개수 초과 시 행 삭제
          row.remove();
        } else {
          // 기본 행은 내용만 삭제
          row.querySelectorAll('input[type="text"]').forEach(input => input.value = '');
          row.querySelector('.word-row-checkbox').checked = false;
        }
      });
      
      renumberWordRows();
      updateSelectAllState();
      document.getElementById('selectAllWords').checked = false;
      
      showToast(`${totalSelected}개 단어가 삭제되었습니다.`);
    }

    // 단어 행 번호 재정렬
    function renumberWordRows() {
      const rows = document.querySelectorAll('#wordInputTable tbody tr');
      rows.forEach((row, idx) => {
        const numCell = row.querySelector('td:nth-child(2)');
        if (numCell) numCell.textContent = idx + 1;
      });
    }

    function addWordRow() {
      const tbody = document.querySelector('#wordInputTable tbody');
      const rowCount = tbody.rows.length + 1;
      const showPos = document.getElementById('colPos').checked;
      const showKor = document.getElementById('colKorDef').checked;
      const showEng = document.getElementById('colEngDef').checked;
      const showExample = document.getElementById('colExample').checked;
      
      const row = document.createElement('tr');
      row.innerHTML = `
        <td style="text-align: center;"><input type="checkbox" class="word-row-checkbox" onchange="updateSelectAllState()"></td>
        <td style="text-align: center;">${rowCount}</td>
        <td><input type="text" placeholder="단어 입력"></td>
        <td class="col-pos" style="display: ${showPos ? '' : 'none'};"><input type="text" placeholder="품사"></td>
        <td class="col-kor-def" style="display: ${showKor ? '' : 'none'};"><input type="text" placeholder="한글 뜻"></td>
        <td class="col-eng-def" style="display: ${showEng ? '' : 'none'};"><input type="text" placeholder="영어 뜻"></td>
        <td class="col-example" style="display: ${showExample ? '' : 'none'};"><input type="text" placeholder="예문"></td>
        <td class="row-delete">
          <button onclick="deleteWordRow(this)">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </td>
      `;
      tbody.appendChild(row);
    }

    // Save Functions
    function saveDraft() {
      showToast('임시 저장되었습니다. 계속 입력해주세요.');
    }

    function saveAndGenerate() {
      closeSidePeek();
      showToast('콘텐츠가 저장되었습니다. AI가 콘텐츠를 생성합니다.');
    }

    // ===== 유효성 검사 =====
    // 기본 정보 검증 (교재, 구분1, 구분2, 난이도)
    function validateBasicInfo() {
      // 교재 선택 확인
      const textbook = document.getElementById('textbookInput').value.trim();
      if (!textbook || !textbookData[textbook]) return false;
      
      const data = textbookData[textbook];
      
      if (data.hasSection2) {
        // 구분2 있는 교재: 구분1, 구분2 모두 선택 필요
        const section1 = document.getElementById('section1SelectWithLesson').value;
        if (!section1) return false;
        if (!selectedSection2) return false;
      } else {
        // 구분2 없는 교재: 구분1만 선택 필요
        const section1 = document.getElementById('section1SelectNoLesson').value;
        if (!section1) return false;
      }
      
      // 단어 난이도 검증
      const passageLevel = document.getElementById('passageLevel').value;
      if (!passageLevel) return false;
      
      return true;
    }

    // 전체 필수값 검증 (저장 버튼용)
    function validateAllRequired() {
      // 기본 정보 검증
      if (!validateBasicInfo()) return false;
      
      // 단어 입력 검증 (최소 1개 이상의 단어 필수)
      const wordInputs = document.querySelectorAll('#wordInputTable tbody tr td:nth-child(3) input');
      const hasWord = Array.from(wordInputs).some(input => input.value.trim());
      if (!hasWord) return false;
      
      return true;
    }


    // 버튼 상태 업데이트
    function updateSaveButtonStates() {
      const btnSaveDraft = document.getElementById('btnSaveDraft');
      const btnSave = document.getElementById('btnSave');
      
      // 저장 후 계속 입력: 기본 정보만 검증
      btnSaveDraft.disabled = !validateBasicInfo();
      
      // 저장: 모든 필수값 검증
      btnSave.disabled = !validateAllRequired();
    }

    // 입력 필드 변경 시 버튼 상태 업데이트
    document.addEventListener('DOMContentLoaded', function() {
      // 구분1 (구분2 없는 교재)
      document.getElementById('section1SelectNoLesson').addEventListener('change', updateSaveButtonStates);
      
      // 구분1 (구분2 있는 교재)
      document.getElementById('section1SelectWithLesson').addEventListener('change', updateSaveButtonStates);
    });

    // 단어 입력 테이블 변경 감지 (동적 요소)
    document.getElementById('wordInputTable').addEventListener('input', function(e) {
      if (e.target.tagName === 'INPUT') {
        updateSaveButtonStates();
      }
    });

    // Toast
    function showToast(message) {
      const toast = document.getElementById('toast');
      document.getElementById('toastMessage').textContent = message;
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }
  </script>
</body>
</html>
